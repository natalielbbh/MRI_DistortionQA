Search.setIndex({"docnames": ["Harmonic_sanity_checks", "Harmonic_stability_checks", "Preamble", "_static/themes/README", "code_docs", "dev_notes", "developer_notes", "examples", "field_calculation", "fit_spherical_harmonics", "index", "marker_extraction", "marker_matching", "marker_position_errors", "reporting"], "filenames": ["Harmonic_sanity_checks.md", "Harmonic_stability_checks.md", "Preamble.md", "_static/themes/README.md", "code_docs.rst", "dev_notes.md", "developer_notes.md", "examples.rst", "field_calculation.md", "fit_spherical_harmonics.md", "index.rst", "marker_extraction.md", "marker_matching.md", "marker_position_errors.md", "reporting.md"], "titles": ["Harmonic sanity checks", "Harmonics perturbation analysis", "Preamble", "&lt;no title&gt;", "Code Documentation", "&lt;no title&gt;", "Developer notes", "Worked Examples", "Field Calculation", "Spherical Harmonics", "MRI Distortion QA", "Marker Extraction", "Marker Matching", "Marker position stability", "Reporting"], "terms": {"thi": [0, 1, 2, 4, 8, 9, 10, 11, 12, 14], "write": [0, 4], "up": [0, 1, 4, 12, 13], "concern": [0, 13], "6": [0, 1, 4, 13], "pair": [0, 11, 12], "taken": [0, 13], "au": [0, 1, 4, 8, 11, 12], "mri": [0, 1, 4, 12], "linac": [0, 1], "magnet": [0, 8, 9, 10], "summar": 0, "below": [0, 1, 4, 9, 10, 11, 12, 13, 14], "slice": [0, 4, 12, 13], "phase": [0, 12], "encod": [0, 11, 12, 13], "transvers": 0, "posterior": 0, "anterior": 0, "sagitt": 0, "head": 0, "feet": 0, "coron": 0, "right": [0, 11], "left": [0, 4, 11], "With": 0, "data": [0, 1, 2, 4, 7, 8, 9, 11, 13], "we": [0, 1, 2, 4, 7, 8, 9, 12, 13, 14], "can": [0, 1, 2, 4, 8, 9, 10, 11, 12, 13, 14], "get": [0, 1, 4, 11, 12, 13, 14], "three": [0, 4, 12, 13], "independ": [0, 4, 10, 12], "estim": [0, 1, 8, 11, 12, 13, 14], "gradient": [0, 1, 4, 7, 8, 9, 11], "The": [0, 1, 2, 4, 9, 10, 11, 12, 13, 14], "purpos": [0, 1, 4, 12, 14], "analysi": [0, 10, 13], "carri": 0, "out": [0, 2, 4, 12, 14], "two": [0, 1, 2, 3, 4, 11, 12, 13, 14], "If": [0, 4, 9, 11, 12, 14], "switch": 0, "between": [0, 4, 12, 13], "e": [0, 1, 4, 11], "g": [0, 1, 4], "ap": [0, 12, 13], "pa": [0, 12], "set": [0, 4, 11, 12, 13], "marker": [0, 1, 7, 8, 10, 14], "match": [0, 1, 4, 7, 8, 9, 10, 11, 14], "step": [0, 2, 7, 8, 10, 11, 14], "still": [0, 4, 11], "veri": [0, 4, 11, 13, 14], "similar": [0, 11], "answer": [0, 11, 12], "all": [0, 2, 4, 10, 11, 12, 13], "also": [0, 1, 4, 9, 11, 12, 13, 14], "have": [0, 1, 4, 8, 9, 10, 11, 12, 13, 14], "phase_encode_direct": 0, "y": [0, 1, 4, 11, 12, 13], "freq_encode_direct": 0, "x": [0, 1, 4, 9, 11, 12, 13], "slice_direct": 0, "z": [0, 1, 4, 11, 12, 13], "ap_pa": 0, "pa_ap": 0, "a11": [0, 4, 9], "721": 0, "a31": 0, "24": 0, "a51": 0, "a10": [0, 4], "9": [0, 1, 4], "14": [0, 1], "b11": [0, 4], "720": 0, "b31": 0, "21": 0, "b51": 0, "23": 0, "444": 0, "a30": 0, "27": 0, "a50": 0, "10": [0, 1, 4], "20": [0, 1, 4], "ar": [0, 1, 2, 4, 9, 11, 12, 13, 14], "lot": [0, 4, 14], "so": [0, 4, 9, 10, 11, 12, 13, 14], "ones": 0, "30": 0, "domin": [0, 1, 4, 9], "a20": [0, 4], "8": [0, 1, 4, 9], "a60": 0, "5": [0, 1, 4, 13], "a80": 0, "7": [0, 1], "rl": [0, 13], "lr": 0, "look": [0, 2, 11, 12, 13, 14], "quit": [0, 1, 4, 11, 13], "except": [0, 1, 4], "sign": [0, 11], "which": [0, 1, 2, 4, 8, 11, 12, 13, 14], "i": [0, 1, 3, 4, 7, 11, 13, 14], "think": [0, 1, 13], "more": [0, 1, 2, 4, 11, 12, 13, 14], "like": [0, 4, 9, 11, 13], "an": [0, 1, 4, 7, 8, 11, 13, 14], "error": [0, 1, 4, 14], "field": [0, 1, 7, 9, 10, 12], "calcul": [0, 1, 7, 9, 10, 12], "than": [0, 1, 4, 13], "hf": [0, 13], "complet": [0, 2, 14], "aren": [0, 4, 11], "even": [0, 1, 11], "being": [0, 4], "excit": 0, "further": [0, 11, 12], "fit": [0, 1, 4, 8, 9, 14], "indic": [0, 4], "non": [0, 1, 12], "physic": [0, 1], "initi": [0, 9], "pk": [0, 1, 4, 9], "50": [0, 1], "709": 0, "\u03bct": [0, 9], "reconstruct": [0, 1, 4, 7, 9], "134": 0, "032": 0, "residu": [0, 9], "104": 0, "138": 0, "ok": [0, 1, 14], "quick": [0, 4, 11], "volum": [0, 1, 4, 8, 11, 12, 13, 14], "tell": [0, 9, 11, 12], "us": [0, 1, 2, 4, 8, 9, 10, 11, 12, 13, 14], "why": [0, 12], "wa": [0, 4, 12, 14], "warp": 0, "turn": [0, 12], "off": [0, 12], "when": [0, 4, 7, 11, 13], "got": 0, "much": [0, 13], "sensibl": 0, "result": [0, 1, 4, 11], "report": [0, 1, 2, 7, 9, 10, 12], "hf_fh": 0, "rl_lr": 0, "3": [0, 1, 11, 13], "perfect": [0, 9], "reason": [0, 1, 4], "stabl": [0, 1], "suggest": [0, 1], "perturb": [0, 4, 9], "ut": [0, 1, 4], "100": [0, 1, 11, 13, 14], "465": 0, "0": [0, 1, 4, 8, 9, 13, 14], "22": 0, "15": [0, 1], "25": 0, "4": [0, 1, 9, 13], "16": [0, 1], "13": [0, 1], "689": 0, "43": 0, "40": 0, "17": [0, 1], "overal": 0, "work": [0, 4, 10, 11, 14], "better": [0, 4, 14], "expect": [0, 1, 4, 9, 12], "would": [0, 1, 9, 11, 12, 13], "go": [0, 1, 11, 13], "far": [0, 1, 9], "sai": [0, 11], "exhibit": 0, "remark": 0, "stabil": [0, 1, 4], "main": [0, 4, 11], "bottom": 0, "case": [0, 2, 4, 7, 9, 11, 12], "ever": 0, "want": [0, 4, 11, 12], "again": [0, 4, 12], "from": [0, 1, 2, 3, 4, 6, 7, 8, 9, 10, 11, 13, 14], "mri_distortionqa": [0, 1, 4, 5, 6, 8, 9, 11, 12, 14], "markeranalysi": [0, 1, 4, 9, 11, 12], "import": [0, 1, 4, 8, 9, 11, 12, 14], "markervolum": [0, 1, 4, 7, 8, 9, 14], "matchedmarkervolum": [0, 1, 4, 12, 13, 14], "pathlib": [0, 1, 4, 8, 9, 11, 12, 14], "path": [0, 1, 4, 8, 9, 11, 12, 14], "fieldcalcul": [0, 1, 4, 8], "convertmatchedmarkerstobz": [0, 1, 4, 8], "fieldanalysi": [0, 1, 4, 9], "sphericalharmonicfit": [0, 1, 4], "here": [0, 1, 2, 3, 4, 9, 11, 12, 13, 14], "http": [0, 1, 3, 4, 8, 11, 12], "cloudstor": [0, 1, 8, 11, 12], "aarnet": [0, 1, 8, 11, 12], "edu": [0, 1, 8, 11, 12], "plu": [0, 1, 8, 11, 12], "app": [0, 1], "file": [0, 1, 4, 11, 12, 14], "dir": [0, 1], "share": [0, 1], "20experiment": [0, 1], "20data": [0, 1], "goam2": [0, 1], "5emr": [0, 1], "20220428": [0, 1], "20mr": [0, 1], "20linac": [0, 1], "5etest": [0, 1], "fileid": [0, 1], "6603039901": [0, 1], "data_loc": [0, 1, 4, 8, 9, 11, 12, 14], "r": [0, 1, 4, 8, 12, 13, 14], "prj": [0, 1], "rpl": [0, 1], "2research": [0, 1], "2_projectdata": [0, 1], "mr": [0, 1, 4, 8, 9, 11, 12, 14], "test": [0, 1, 4, 6, 7], "all_scan": [0, 1], "01": [0, 1, 9], "localiser_gr": [0, 1], "02": [0, 1], "gre_trans_ap_330": [0, 1, 8, 9, 11, 12, 14], "03": [0, 1], "gre_trans_pa_330": [0, 1, 11, 12], "04": [0, 1, 8, 9, 11, 12, 14], "gre_sag_hf_330": [0, 1], "05": [0, 1, 11, 12], "gre_sag_fh_330": [0, 1], "06": [0, 1], "gre_cor_rl_330": [0, 1], "07": [0, 1], "08": [0, 1], "gre_trans_ap_330_f_reset": [0, 1], "09": [0, 1], "11": [0, 1, 12, 13], "gre_trans_pa": [0, 1], "12": [0, 1], "gre_sag_hf": [0, 1], "gre_sag_fh": [0, 1], "gre_cor_rl": [0, 1], "gre_cor_lr": [0, 1], "gre_tran_ap_large_bw": [0, 1], "gre_tran_pa_large_bw": [0, 1], "18": [0, 1], "gre_trans_pa_reshim_refreq": [0, 1], "19": [0, 1], "gre_trans_ap_reshim_refreq": [0, 1], "correct_fw": [0, 1], "true": [0, 1, 4, 11, 13, 14], "ct_volum": [0, 1], "ct": [0, 1, 11, 12], "mrk": [0, 1, 11, 12], "json": [0, 1, 4, 7, 8, 9, 11, 14], "forward_volum": [0, 1], "origin": [0, 1, 4], "gaussian_image_filter_sd": [0, 1, 4], "n_markers_expect": [0, 1, 4], "336": [0, 1], "cutoff_point": [0, 1, 4], "verbos": [0, 1, 4, 11, 12], "fals": [0, 1, 4, 11, 12, 14], "r_max": [0, 1, 4, 11, 12, 14], "165": [0, 1], "correct_fat_water_shift": [0, 1, 4, 11], "fat_shift_direct": [0, 1, 4, 11], "back_volum": [0, 1], "b0_harmonics_ap": 0, "g_x_harmonics_ap": 0, "g_y_harmonics_ap": 0, "g_z_harmonics_ap": 0, "calculate_harmon": [0, 1, 9, 10], "b0_harmonics_rl": 0, "g_x_harmonics_rl": 0, "g_y_harmonics_rl": 0, "g_z_harmonics_rl": 0, "fh": 0, "save_dicom_data": [0, 4, 8, 12], "save_path": [0, 4, 11], "__file__": 0, "parent": 0, "export_to_slic": [0, 4, 11, 12], "b0_harmonics_hf": 0, "g_x_harmonics_hf": 0, "g_y_harmonics_hf": 0, "g_z_harmonics_hf": 0, "our": [1, 4, 11, 12, 14], "workflow": [1, 2, 10, 11], "reli": [1, 2], "extract": [1, 4, 7, 10, 12, 13], "coordin": [1, 4, 11], "imag": [1, 2, 4, 10, 11, 12, 13], "them": [1, 2, 4, 11, 12], "character": [1, 10, 12], "spheric": [1, 4, 7, 8, 10, 12, 14], "howev": [1, 4, 12, 13], "find": [1, 4, 7], "centroid": [1, 12], "trivial": 1, "task": 1, "hinder": 1, "low": [1, 4, 9, 11], "snr": [1, 11], "larg": [1, 11], "voxel": [1, 4, 11, 13], "size": [1, 4, 11, 13], "other": [1, 4, 10, 11], "thing": [1, 2, 4, 7, 11], "t": [1, 4, 8, 11, 12, 14], "therefor": [1, 9, 11, 12, 13, 14], "assess": [1, 6], "larger": [1, 13], "introduc": [1, 13], "posit": [1, 4, 7, 8, 12, 14], "perturb_marker_posit": [1, 4], "method": [1, 4, 11, 12], "todo": [1, 9], "plot": [1, 4, 7, 11, 12, 14], "show": [1, 8, 9, 11, 12, 13], "percentag": 1, "perurb": 1, "unabl": [1, 12], "first": [1, 2, 11], "second": [1, 2, 9], "third": 1, "most": [1, 4, 9, 11, 12, 13, 14], "each": [1, 2, 4, 8, 9, 10, 11, 12, 13], "what": [1, 4, 7, 11, 13, 14], "see": [1, 4, 9, 11, 12, 13], "biggest": 1, "good": [1, 4, 9, 11, 12, 13, 14], "sinc": [1, 11, 12], "should": [1, 2, 4, 7, 11, 13, 14], "It": [1, 4, 11], "s": [1, 4, 8, 11, 12, 13, 14], "comfort": 1, "start": [1, 2, 4, 12], "inher": 1, "segment": [1, 4, 11], "repres": 1, "itself": [1, 8], "stai": 1, "less": [1, 4], "1": [1, 4, 7, 9, 11, 12, 13], "variat": 1, "random": [1, 4, 11, 13], "mm": [1, 4, 9, 13], "creat": [1, 2, 4, 7, 8, 11, 14], "function": [1, 4, 9], "compar": [1, 4, 7, 12], "1mm": 1, "follow": [1, 6, 9, 12], "In": [1, 2, 4, 9, 11, 12], "gener": [1, 2, 4, 5, 6, 9, 12, 13, 14], "around": [1, 4, 13], "same": [1, 4, 11], "ammount": 1, "nois": [1, 4, 11], "major": [1, 7], "within": [1, 4, 9, 11], "outlier": [1, 12], "well": [1, 4, 7, 10, 11], "abov": [1, 11, 12], "rel": [1, 4, 9], "few": [1, 11, 12], "arrang": 1, "surfac": [1, 4, 9, 14], "sphere": [1, 4, 9, 14], "hypothes": 1, "phantom": [1, 11, 12, 13, 14], "especi": 1, "sensit": [1, 4], "interest": [1, 4], "repeat": 1, "dens": 1, "sampl": [1, 9, 11, 12], "probabl": [1, 9, 13], "won": 1, "keep": 1, "long": 1, "term": [1, 4, 12], "now": [1, 11, 14], "numpi": [1, 4, 11], "np": [1, 4, 9, 11], "copi": [1, 4, 11, 12, 14], "deepcopi": 1, "matplotlib": [1, 4], "pyplot": [1, 4], "plt": 1, "def": [1, 14], "ground_truth_volum": [1, 12], "none": [1, 4, 9], "n_order": [1, 4, 9], "matched_mark": [1, 8, 12, 14], "sorting_method": [1, 4], "radial": [1, 4], "referencemark": [1, 4, 12], "warpsearchdata": [1, 4], "reversegradientdata": [1, 4, 12], "matchedcentroid": [1, 4, 12], "to_csv": [1, 8, 9, 12], "csv": [1, 4, 8, 9, 12, 14], "b": [1, 4], "b_field": 1, "dicom_data": [1, 4, 8, 9, 12, 14], "b0": [1, 4, 8, 11, 12, 13, 14], "try": [1, 4, 12, 14], "b0_data": 1, "magneticfield": [1, 4, 8], "renam": 1, "column": [1, 4, 8, 9, 11, 14], "bz": [1, 4], "receiev": 1, "one": [1, 4, 11, 12, 14], "call": [1, 4, 11, 12, 14], "b0_harmon": [1, 4, 9, 14], "r_outer": [1, 4, 9, 11, 14], "150": [1, 4, 9, 11, 14], "keyerror": 1, "gx": [1, 4], "gradxdata": 1, "b_gx": [1, 4], "g_x_harmon": [1, 4, 9, 14], "gy": [1, 4], "gradydata": 1, "b_gy": [1, 4], "g_y_harmon": [1, 4, 9, 14], "g_z": 1, "gradzdata": 1, "b_gz": [1, 4], "g_z_harmon": [1, 4, 9, 14], "return": [1, 4, 14], "normalise_array_columnwis": 1, "array_to_normalis": 1, "enumer": 1, "2": [1, 4, 7, 9, 13], "linspac": 1, "b0_harmonics_gt": 1, "g_x_harmonics_gt": 1, "g_y_harmonics_gt": 1, "g_z_harmonics_gt": 1, "forward_volume_perturb": 1, "record": 1, "append": 1, "_residual_pk_pk": 1, "a_1_1": 1, "b_1_1": 1, "a_1_0": 1, "a_3_1": 1, "b_3_1": 1, "a_3_0": 1, "a_5_1": 1, "b_5_1": 1, "a_5_0": 1, "transform": [1, 4], "list": [1, 4, 11, 12], "valu": [1, 4, 12], "arrai": [1, 4, 9], "fig": 1, "ax": 1, "subplot": 1, "nrow": 1, "ncol": 1, "figsiz": 1, "set_titl": 1, "set_xlabel": 1, "set_ylabel": 1, "legend": [1, 4], "tight_layout": 1, "let": [1, 11, 13, 14], "make": [1, 4, 11], "unperturb": 1, "mri_qa_report": [1, 4, 14], "util": [1, 9, 10, 11], "compare_recon_report_with_ground_truth_report": [1, 4], "unperturbed_report": 1, "gradient_harmon": [1, 4, 14], "perturbed_report": 1, "These": [2, 12], "exampl": [2, 4, 8, 10, 14], "constitut": 2, "distort": [2, 4, 9, 11, 12, 14], "qa": 2, "dicom": [2, 4, 7], "end": [2, 10], "split": 2, "section": [2, 12, 14], "simpl": [2, 4, 7], "code": [2, 7, 10, 11, 12, 14], "demonstr": [2, 11, 12, 14], "onli": [2, 4, 8, 12], "need": [2, 4, 11, 12, 13], "move": [2, 4, 9, 11, 12, 14], "next": [2, 7, 8, 11], "provid": [2, 9, 11, 12], "detail": [2, 12], "note": [2, 4, 9, 11, 12], "includ": [2, 4, 12, 14], "how": [2, 4, 7, 8, 11, 14], "handl": [2, 4, 7], "some": [2, 4, 7, 11, 12, 13, 14], "trick": 2, "situat": [2, 9, 11, 12], "mai": [2, 4, 11], "aris": 2, "design": [2, 12, 14], "modular": 2, "you": [2, 4, 8, 9, 10, 11, 12, 13, 14], "jump": 2, "whatev": [2, 4], "point": [2, 4, 9, 11, 14], "pleas": [2, 11], "But": [2, 12], "recommend": [2, 12], "order": [2, 4, 9], "becaus": [2, 11, 12, 13, 14], "futur": 2, "former": [2, 4, 12], "sourc": [2, 9, 11, 12], "intend": 2, "everi": [2, 4, 12], "possibl": 2, "do": [2, 4, 7, 8, 9, 13, 14], "explain": [2, 7], "edg": 2, "document": [2, 10, 11, 12, 14], "took": [3, 12], "theme": 3, "github": 3, "com": [3, 4], "leonwong0609": 3, "typora": 3, "d42ker": 3, "default": [3, 4, 11], "time": [3, 4, 11], "neither": 3, "had": 3, "ani": [3, 4, 9, 10, 12], "licens": 3, "associ": 3, "class": [4, 12, 13, 14], "input_data": 4, "imextens": 4, "dcm": 4, "r_min": 4, "iterative_segment": 4, "marker_size_lower_tol": 4, "marker_size_upper_tol": 4, "either": 4, "folder": 4, "attempt": [4, 12], "automat": [4, 11, 12, 14], "latter": [4, 12], "just": [4, 9, 11, 12], "input": [4, 9, 10], "onc": [4, 8, 11], "instanc": [4, 9], "contain": [4, 12], "number": [4, 9, 13], "handi": 4, "paramet": [4, 12], "input_data_path": 4, "string": [4, 14], "ndarrai": 4, "correspond": [4, 9, 12], "str": 4, "option": [4, 11, 12], "chang": [4, 11], "extens": [4, 12], "your": [4, 7, 12, 14], "commonli": 4, "ima": 4, "float": 4, "radii": 4, "discount": [4, 12], "greater": 4, "bool": [4, 14], "slower": 4, "iter": 4, "threshold": 4, "otherwis": 4, "otsu": 4, "manual": [4, 11], "replac": 4, "regardless": 4, "flag": 4, "int": 4, "know": [4, 9, 11, 12], "mani": [4, 11], "enter": 4, "warn": [4, 9, 11, 12, 14], "differ": [4, 11, 12, 13, 14], "filter": 4, "blur": 4, "higher": 4, "remov": 4, "prior": [4, 12], "small": 4, "signal": [4, 11], "correct": [4, 9, 11], "fat": [4, 7], "water": [4, 7], "shift": [4, 7], "lower": 4, "accept": 4, "window": 4, "median": 4, "markermarker_size_tol": 4, "median_marker_s": 4, "marker_s": 4, "upper": 4, "print": [4, 9, 12], "info": 4, "about": [4, 11, 12, 13], "process": [4, 7, 11], "screen": [4, 9], "mostli": 4, "dure": 4, "debug": 4, "sure": [4, 11], "yet": [4, 11], "confid": [4, 9, 11], "predict": [4, 11], "direct": [4, 11, 12, 13, 14], "take": [4, 11, 12], "pull": [4, 12], "request": [4, 12], "easier": 4, "welcom": 4, "filenam": [4, 11], "slicer_centroid": [4, 11, 12], "export": [4, 12], "read": [4, 11, 12], "slicer": [4, 7], "allow": [4, 8, 11, 12], "wai": [4, 11, 12, 14], "visualis": [4, 9], "perform": [4, 12], "save": [4, 8, 9, 11, 12, 14], "spot": 4, "random_perturb": 4, "systemic_perturb": 4, "add": [4, 11, 14], "oper": 4, "place": [4, 11, 12], "limit": [4, 9, 12, 14], "uniform": 4, "distribut": [4, 13], "constant": 4, "offset": [4, 11, 12], "ad": [4, 7], "plot_3d_mark": [4, 11, 12], "titl": 4, "3d": 4, "saniti": [4, 12], "check": [4, 9, 11, 12, 13], "groundtruthdata": 4, "distorteddata": 4, "automatchmark": 4, "allowdoublematch": 4, "object": [4, 12], "boolean": 4, "found": 4, "updat": [4, 6, 11, 12], "ground": [4, 11, 12, 14], "truth": [4, 11, 12, 14], "recomend": 4, "substanti": 4, "present": [4, 12], "search": [4, 10], "algorith": 4, "simpli": [4, 11, 12], "were": 4, "through": [4, 11], "sometim": [4, 11], "chain": 4, "reaction": 4, "where": [4, 9, 11, 12], "mismatch": 4, "too": [4, 13], "doubl": 4, "delet": [4, 11], "nearest": 4, "build": 4, "motion": 4, "model": 4, "fly": 4, "base": [4, 11, 12], "previous": [4, 12], "seen": [4, 14], "For": [4, 10, 11, 12, 13], "success": 4, "bit": [4, 11, 13], "untest": 4, "featur": [4, 11], "n": 4, "inner_most": 4, "refer": 4, "align": [4, 11, 12], "befor": 4, "setup": [4, 5, 6], "alwai": [4, 12], "best": [4, 11, 13], "matter": [4, 11, 12, 13], "add_arrow": 4, "similarli": 4, "version": 4, "both": [4, 12, 14], "arrow": [4, 11], "drawn": 4, "plot_compressed_mark": 4, "z_max": 4, "z_min": 4, "compress": 4, "plane": [4, 9], "2d": 4, "maximum": 4, "coordiant": 4, "minimum": 4, "panda": [4, 8, 9, 11, 14], "frame": [4, 11, 14], "x_gt": 4, "y_gt": 4, "z_gt": 4, "x_gnl": 4, "y_gnl": 4, "z_gnl": 4, "x_b0": 4, "y_b0": 4, "z_b0": 4, "Such": 4, "datafram": [4, 11], "normal": 4, "dictionari": 4, "requir": [4, 12], "marker_volum": [4, 11], "fov": 4, "400": 4, "bandwidth": 4, "203": 4, "gama": 4, "42": 4, "image_s": 4, "256": 4, "input_bz_data": 4, "assessharmonicpk_pk": 4, "quantifyfit": 4, "trimdataby_r_out": 4, "scale": 4, "singl": 4, "decomposit": 4, "inputdata": 4, "A": [4, 9, 11, 12], "radiu": 4, "reconstuct": 4, "ly": 4, "outsid": 4, "final": [4, 14], "mean": [4, 9, 11], "doesn": 4, "satisfi": [4, 11], "nyquist": 4, "criterion": 4, "figur": [4, 9, 14], "spuriou": 4, "applic": 4, "contribut": 4, "interpret": 4, "abstract": 4, "ha": [4, 9, 12], "intent": 4, "normalis": [4, 9], "strength": 4, "To": [4, 11, 12, 13, 14], "gradient_strength": [4, 9], "mt": 4, "m": [4, 6, 9], "plot_cut_plan": [4, 9], "resolut": [4, 12], "addcolorbar": 4, "quantiti": 4, "vmin": 4, "vmax": 4, "cardin": [4, 9], "basic": [4, 7, 9, 10], "row": 4, "color": 4, "bar": [4, 11], "reconstruct_bz": 4, "must": 4, "imshow": 4, "control": [4, 11], "map": 4, "bound": 4, "plot_harmonics_pk_pk": [4, 9], "cut_off": [4, 9], "produc": [4, 11], "barplot": 4, "cutoff": 4, "highest": 4, "ignor": [4, 9, 12], "print_key_harmon": [4, 9], "termin": 4, "defaulttestsuit": [4, 14], "run": [4, 6, 14], "specifi": [4, 11], "test_distortion_less_than_2mm_within_r_100": 4, "test_distortion_less_than_4mm_within_r_150": 4, "elekta_distortion_test": 4, "geometr": [4, 10, 12], "elekta": 4, "system": [4, 12, 13], "describ": 4, "aapm": 4, "onlinelibrari": 4, "wilei": 4, "doi": 4, "epdf": 4, "1002": 4, "mp": 4, "14764": 4, "test_distortion_less_than_1_mm_within_r_100_mm": 4, "test_distortion_less_than_2_mm_within_r_150_mm": 4, "test_distortion_less_than_4_mm_within_r_200_mm": 4, "recon_coords_cartesian": 4, "tests_to_run": [4, 14], "show_plot": 4, "style": 4, "dark": 4, "seri": [4, 13], "element": 4, "homogen": [4, 11, 14], "recon_coord": 4, "serv": 4, "name": [4, 11], "space": 4, "insid": 4, "identifi": 4, "access": [4, 14], "everyth": 4, "dict": 4, "doe": [4, 8], "inform": [4, 12], "acquisit": [4, 13], "idea": 4, "approach": [4, 12], "determin": 4, "shown": 4, "browser": [4, 14], "thei": [4, 11, 12], "At": [4, 11], "moment": 4, "light": 4, "write_html_report": [4, 14], "output_fold": 4, "html": [4, 14], "encompass": 4, "avail": [4, 12], "interc": 4, "plotli": 4, "mr_qa_report": 4, "tg284_test": 4, "defin": [4, 10, 12], "full": [4, 9, 12], "14695": 4, "test_distortion_less_than_1mm_within_r_100": 4, "test_distortion_less_than_2mm_within_r_200": 4, "reusabl": 4, "bcolor": 4, "enabl": [4, 10], "me": 4, "pretti": [4, 9, 14], "linux": 4, "build_dicom_affin": 4, "dicomfil": 4, "affin": 4, "matrix": 4, "nibabel": 4, "c": [4, 5, 6, 8, 12, 14], "under": [4, 11], "pydicom": 4, "dataset": [4, 11, 13], "filedataset": 4, "read_fil": 4, "coordinatematrix": 4, "4x4": 4, "j": 4, "k": 4, "world": 4, "ground_truth_report": 4, "recon_report": 4, "toler": 4, "mri_qa_recon_report": 4, "via": [4, 11], "although": [4, 11], "principl": 4, "convert_cartesian_to_spher": 4, "inputcoord": 4, "convert": [4, 8, 11], "cartesian": 4, "azimuth": 4, "elev": 4, "alreadi": [4, 13], "exist": [4, 11], "overwritten": 4, "convent": [4, 14], "matlab": 4, "pi": 4, "There": [4, 11, 12, 14], "rememb": 4, "anymor": 4, "stick": 4, "tradit": 4, "least": 4, "addit": [4, 12], "convert_spherical_harmon": 4, "input_format": 4, "output_format": 4, "formal": 4, "fulli": 4, "unnormalis": 4, "could": 4, "later": [4, 8, 9, 11, 12], "g_x_harmonics_no_norm": 4, "a00": 4, "a21": 4, "b21": 4, "a22": 4, "b22": 4, "etc": [4, 11], "format": 4, "output": [4, 7, 10], "convert_spherical_to_cartesian": 4, "dicom_to_numpi": 4, "path_to_dicom": 4, "filestoreadin": 4, "file_extens": 4, "return_xyz": 4, "zero_pad": 4, "load": [4, 8], "accord": 4, "store": [4, 11], "By": 4, "type": [4, 11, 14], "subset": 4, "matric": 4, "coord": 4, "pixel": [4, 13], "zero": 4, "accordingli": 4, "self": [4, 14], "consist": [4, 12], "affect": 4, "imagearrai": 4, "dicom_affin": 4, "enumerate_subfold": 4, "subfold": 4, "folder1": 4, "folder2": 4, "my": 4, "script": 4, "generate_legendre_basi": 4, "utilis": 4, "mathwork": 4, "help": [4, 11, 13], "ref": 4, "legendr": 4, "_": 4, "1000": 4, "ensur": 4, "numer": 4, "assumpt": 4, "throw": 4, "appear": [4, 9, 12], "legendre_basi": 4, "ncoord": 4, "get_all_fil": 4, "pathtodata": 4, "collect": 4, "get_dicom_data": [4, 9], "whether": 4, "get_gradient_spherical_harmon": 4, "gx_harmon": 4, "gy_harmon": 4, "gz_harmon": 4, "clean": 4, "user": [4, 8, 12, 14], "componet": 4, "noth": 4, "cleaner": 4, "elsewher": 4, "pandas": 4, "plot_markervolume_overlai": [4, 11], "markervolumelist": 4, "overlaid": 4, "scatter": 4, "displai": [4, 14], "plot_matchedmarkervolume_hist": 4, "matchedmarkervolumelist": 4, "histogram": 4, "absolut": [4, 13], "plot_compressed_markervolum": [4, 11], "overlai": [4, 13], "max": [4, 14], "min": 4, "arbitrari": 4, "deriv": 4, "shape": 4, "raw": 4, "thrown": 4, "bz_recon": 4, "sort_dicom_slic": 4, "dicom_dataset": 4, "sort": 4, "param": 4, "norm": [4, 9], "essenti": [4, 12], "wrapper": 4, "conveni": 4, "given": [4, 11], "gz": 4, "strengt": 4, "unit": 4, "reflect": 4, "pass": [4, 7, 11], "four": 4, "valuu": 4, "divid": 4, "interrog": 5, "badg": [5, 6, 8], "cfg": [5, 6], "vv": 5, "o": [5, 6, 8], "docsrc": [5, 6, 8], "__resourc": [5, 6, 8], "svg": [5, 6], "coverag": [5, 8], "f": [5, 6, 8, 12], "root": 6, "directori": [6, 11, 14], "v": 6, "pytest": 6, "preambl": [7, 10], "guarante": 7, "Is": 7, "issu": [7, 12, 13], "edit": 7, "fail": [7, 11, 14], "incorpor": 7, "revers": [7, 8, 11], "intepret": 7, "versu": 7, "harmon": [7, 8, 10, 12], "directli": [7, 12], "custom": 7, "coil": [8, 9, 12], "techniqu": [8, 12], "svgbash": 8, "pd": [8, 9, 11, 14], "download": [8, 11, 12, 14], "unzip": [8, 11, 12], "wm9vndv47u941ju": [8, 11, 12], "brendan": [8, 11, 12, 14], "mri_distortion_qa_sample_data": [8, 11, 12, 14], "previou": [8, 12, 14], "matched_volum": [8, 12], "read_csv": [8, 9, 14], "index_col": [8, 9, 14], "squeez": [8, 9, 14], "dicom_data_loc": [8, 9, 14], "previosli": [8, 9, 14], "bz_field": 8, "bfield": [8, 9], "realli": [8, 14], "intermidi": 8, "isn": 8, "particularli": [8, 12], "characteris": 9, "free": [9, 11], "region": 9, "practic": 9, "underli": 9, "anywher": 9, "particualrli": 9, "algorithsm": 9, "rich": 9, "fielddata": 9, "_example_data": [9, 12], "1e3": 9, "normalisation_factor": 9, "1mt": 9, "did": 9, "distorted_volume_rev": [9, 12], "handli": 9, "quickli": [9, 11], "strong": 9, "variant": 9, "close": [9, 11, 13], "zy": 9, "nerd": 9, "gratifi": 9, "strongli": 9, "express": 9, "py": [9, 12, 14], "line": 9, "86": 9, "cover": 9, "693": 9, "401": 9, "795": 9, "023": 9, "suffici": 9, "autom": 9, "part": [9, 10, 11, 14], "peak": 9, "over": [9, 11, 12, 13], "total": 9, "readi": 9, "onto": 9, "reson": 10, "tutori": [10, 12, 14], "click": [10, 11], "diagram": 10, "index": 10, "modul": [10, 12], "page": 10, "built": [11, 12], "librari": 11, "somewher": 11, "mri_qa_tutori": 11, "someth": [11, 13], "new": [11, 12, 14], "python": [11, 12], "markerextractionexampl": 11, "home": 11, "gt_data_loc": 11, "put": [11, 12], "gt_volum": 11, "300": [11, 12], "variou": [11, 12], "difficult": 11, "markercentroid": [11, 13], "consum": 11, "back": [11, 12], "As": 11, "impli": 11, "locat": [11, 12], "instead": 11, "argument": 11, "gt_volume_from_json": 11, "continu": 11, "mr_data_loc": 11, "mr_data_loc_reverse_gradi": 11, "mr_volum": 11, "test_data": [11, 14], "rand": 11, "pandas_volum": 11, "rest": 11, "advanc": 11, "common": 11, "mr_volume_rev": 11, "short": [11, 12], "No": 11, "variabl": 11, "knowledg": [11, 12], "contrast": 11, "abl": 11, "reliabl": 11, "combin": 11, "scan": 11, "scanner": [11, 12], "easi": 11, "interfac": 11, "excel": 11, "gui": 11, "screenshot": 11, "offici": 11, "markup": 11, "unwant": 11, "hover": 11, "while": [11, 12], "highlight": 11, "without": 11, "mous": 11, "press": 11, "activ": 11, "menu": 11, "select": 11, "toggl": 11, "toolbar": 11, "blue": 11, "red": 11, "dot": 11, "hand": 11, "circl": 11, "multipl": 11, "confusingli": 11, "icon": 11, "newli": 11, "tool": [11, 13], "middl": 11, "awai": 11, "attach": 11, "don": [11, 12, 13, 14], "worri": 11, "annoi": 11, "unlock": 11, "littl": 11, "padlock": 11, "symbol": 11, "cross": 11, "lock": 11, "per": 11, "drag": 11, "els": [11, 14], "give": [11, 13], "edited_volum": 11, "edited_fil": 11, "information_sourc": 11, "buggi": 11, "laggi": 11, "fix": 11, "disappoint": 11, "oil": 11, "fill": 11, "subject": 11, "forward": 11, "dsv": 11, "due": 11, "effect": [11, 12], "softwar": [11, 12], "marker_volume_forward": 11, "marker_volume_back": 11, "appli": 11, "chemic": 11, "axi": 11, "occur": 11, "frequenc": [11, 12], "center": [11, 12, 13], "apart": 11, "log": [11, 12], "develop": 11, "quantifi": [12, 13], "technic": 12, "cad": 12, "marker_match": 12, "content": 12, "distorted_volum": 12, "succes": 12, "speed": 12, "high": 12, "minut": 12, "depend": 12, "achiev": 12, "come": 12, "parmet": 12, "inner": [12, 13], "rigid": 12, "necessari": 12, "mess": 12, "yourself": 12, "exactli": 12, "accident": 12, "matched_volume_no_ref": 12, "Not": 12, "might": 12, "firstli": 12, "doc": 12, "hard": 12, "problem": 12, "solv": 12, "extrem": 12, "guess": 12, "algorithm": 12, "inhomogen": 12, "patient": 12, "specif": 12, "sequenc": 12, "standard": 12, "readout": 12, "highli": 12, "seper": 12, "explait": 12, "instruct": 12, "siemen": 12, "analys": 12, "send": 12, "matched_volume_with_rev_data": 12, "visibl": 12, "gnl": 12, "promin": 12, "kei": 12, "item": 12, "recreat": 12, "obtain": 12, "measur": [12, 14], "disort": 12, "distortoin": 12, "linear": 12, "alon": 12, "ideal": 12, "easili": 12, "extra": 12, "anywai": 12, "never": 12, "tidier": 12, "rid": 12, "whenev": 12, "seriou": 13, "grip": 13, "sever": 13, "largest": 13, "thick": 13, "influenc": 13, "static": 13, "ap_volum": 13, "reset_index": 13, "drop": 13, "clearli": 13, "inde": 13, "central": 13, "tabl": 13, "200722": 13, "796672": 13, "62996": 13, "559205": 13, "048565": 13, "288829": 13, "087395": 13, "587143": 13, "508799": 13, "004159": 13, "111853": 13, "416738": 13, "448163": 13, "258656": 13, "275514": 13, "881676": 13, "537472": 13, "586933": 13, "368377": 13, "440425": 13, "309114": 13, "957465": 13, "112788": 13, "367208": 13, "63493": 13, "806967": 13, "393177": 13, "921969": 13, "09255": 13, "96696": 13, "139105": 13, "900554": 13, "397762": 13, "actual": [13, 14], "bad": [13, 14], "deal": 13, "tend": 13, "entir": 13, "compon": 13, "enough": 13, "fancier": 13, "eyebal": 13, "ap_rl": 13, "ap_hf": 13, "hf_rl": 13, "mayb": 13, "journei": 14, "interact": 14, "conta": 14, "your_home_directori": 14, "honest": 14, "routin": 14, "datapoint": 14, "appropri": 14, "occasion": 14, "firefox": 14, "haven": 14, "address": 14, "wasn": 14, "understood": 14, "recontruct": 14, "sit": 14, "notic": 14, "been": 14, "own": 14, "creation": 14, "suit": 14, "customtestsuit": 14, "test_case_1": 14, "test_case_2": 14, "am": 14, "test_case_3": 14, "_extract_data_from_matchedmarkervolum": 14, "abs_di": 14}, "objects": {"MRI_DistortionQA": [[4, 0, 0, "-", "FieldAnalysis"], [4, 0, 0, "-", "FieldCalculation"], [4, 0, 0, "-", "MarkerAnalysis"], [4, 0, 0, "-", "Reports"], [4, 0, 0, "-", "calculate_harmonics"], [4, 0, 0, "-", "utilities"]], "MRI_DistortionQA.FieldAnalysis": [[4, 1, 1, "", "SphericalHarmonicFit"]], "MRI_DistortionQA.FieldAnalysis.SphericalHarmonicFit": [[4, 2, 1, "", "plot_cut_planes"], [4, 2, 1, "", "plot_harmonics_pk_pk"], [4, 2, 1, "", "print_key_harmonics"]], "MRI_DistortionQA.FieldCalculation": [[4, 1, 1, "", "ConvertMatchedMarkersToBz"]], "MRI_DistortionQA.MarkerAnalysis": [[4, 1, 1, "", "MarkerVolume"], [4, 1, 1, "", "MatchedMarkerVolumes"]], "MRI_DistortionQA.MarkerAnalysis.MarkerVolume": [[4, 2, 1, "", "export_to_slicer"], [4, 2, 1, "", "perturb_marker_positions"], [4, 2, 1, "", "plot_3D_markers"], [4, 2, 1, "", "save_dicom_data"]], "MRI_DistortionQA.MarkerAnalysis.MatchedMarkerVolumes": [[4, 2, 1, "", "plot_3D_markers"], [4, 2, 1, "", "plot_compressed_markers"]], "MRI_DistortionQA.Reports": [[4, 1, 1, "", "DefaultTestSuite"], [4, 1, 1, "", "Elekta_Distortion_tests"], [4, 1, 1, "", "MRI_QA_Reporter"], [4, 1, 1, "", "TG284_Tests"]], "MRI_DistortionQA.Reports.DefaultTestSuite": [[4, 2, 1, "", "test_distortion_less_than_2mm_within_r_100"], [4, 2, 1, "", "test_distortion_less_than_4mm_within_r_150"]], "MRI_DistortionQA.Reports.Elekta_Distortion_tests": [[4, 2, 1, "", "test_distortion_less_than_1_mm_within_r_100_mm"], [4, 2, 1, "", "test_distortion_less_than_2_mm_within_r_150_mm"], [4, 2, 1, "", "test_distortion_less_than_4_mm_within_r_200_mm"]], "MRI_DistortionQA.Reports.MRI_QA_Reporter": [[4, 2, 1, "", "write_html_report"]], "MRI_DistortionQA.Reports.TG284_Tests": [[4, 2, 1, "", "test_distortion_less_than_1mm_within_r_100"], [4, 2, 1, "", "test_distortion_less_than_2mm_within_r_200"]], "MRI_DistortionQA.calculate_harmonics": [[4, 3, 1, "", "calculate_harmonics"]], "MRI_DistortionQA.utilities": [[4, 1, 1, "", "bcolors"], [4, 3, 1, "", "build_dicom_affine"], [4, 3, 1, "", "compare_recon_report_with_ground_truth_report"], [4, 3, 1, "", "convert_cartesian_to_spherical"], [4, 3, 1, "", "convert_spherical_harmonics"], [4, 3, 1, "", "convert_spherical_to_cartesian"], [4, 3, 1, "", "dicom_to_numpy"], [4, 3, 1, "", "enumerate_subfolders"], [4, 3, 1, "", "generate_legendre_basis"], [4, 3, 1, "", "get_all_files"], [4, 3, 1, "", "get_dicom_data"], [4, 3, 1, "", "get_gradient_spherical_harmonics"], [4, 3, 1, "", "plot_MarkerVolume_overlay"], [4, 3, 1, "", "plot_MatchedMarkerVolume_hist"], [4, 3, 1, "", "plot_compressed_MarkerVolumes"], [4, 3, 1, "", "reconstruct_Bz"], [4, 3, 1, "", "sort_dicom_slices"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "function", "Python function"]}, "titleterms": {"harmon": [0, 1, 4, 9, 13, 14], "saniti": 0, "check": [0, 6], "intro": 0, "1": [0, 14], "order": 0, "forward": 0, "revers": [0, 12], "imag": 0, "shouldn": 0, "t": [0, 13], "effect": 0, "gx": 0, "gy": 0, "gz": 0, "b0": 0, "2": [0, 14], "differ": [0, 1], "plane": 0, "direct": 0, "should": [0, 12], "give": 0, "same": 0, "conclus": 0, "python": 0, "script": 0, "perturb": 1, "analysi": [1, 4], "comparison": 1, "residu": 1, "predict": 1, "distort": [1, 10], "set": 1, "code": [1, 4, 9], "preambl": 2, "document": 4, "marker": [4, 11, 12, 13], "field": [4, 8], "calcul": [4, 8], "report": [4, 14], "util": 4, "calculate_harmon": 4, "develop": 6, "note": 6, "docstr": 6, "coverag": 6, "interrog": 6, "work": [7, 12], "exampl": [7, 9, 11, 12], "content": [7, 10], "spheric": 9, "some": 9, "plot": 9, "explain": 9, "output": 9, "next": [9, 12], "step": [9, 12], "mri": 10, "qa": 10, "indic": 10, "tabl": 10, "extract": 11, "basic": 11, "compar": 11, "markervolum": [11, 12], "do": [11, 12], "we": 11, "guarante": 11, "find": 11, "your": 11, "Is": 11, "major": 11, "issu": 11, "edit": 11, "posit": [11, 13], "slicer": 11, "handl": 11, "fat": 11, "water": 11, "shift": 11, "match": 12, "simpl": 12, "an": 12, "thing": 12, "well": 12, "what": 12, "i": 12, "when": 12, "process": 12, "fail": 12, "incorpor": 12, "gradient": 12, "data": [12, 14], "how": 12, "intepret": 12, "creat": 12, "from": 12, "dicom": 12, "versu": 12, "json": 12, "stabil": 13, "If": 13, "thi": 13, "our": 13, "averag": 13, "error": 13, "why": 13, "aren": 13, "wors": 13, "case": 14, "pass": 14, "directli": 14, "reconstruct": 14, "ad": 14, "custom": 14, "test": 14}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.todo": 2, "sphinx": 56}})